# DVC (Data Version Control) - Detailed Documentation

## üìö Table of Contents

1. [Introduction](#introduction)
2. [Core Concepts](#core-concepts)
3. [Installation & Setup](#installation--setup)
4. [Project Initialization](#project-initialization)
5. [Remote Storage Configuration](#remote-storage-configuration)
6. [Adding & Tracking Data](#adding--tracking-data)
7. [DVC Files & Metadata](#dvc-files--metadata)
8. [Common Workflows](#common-workflows)
9. [Advanced Commands](#advanced-commands)
10. [Best Practices](#best-practices)
11. [Troubleshooting](#troubleshooting)
12. [Integration with Git](#integration-with-git)

---

## Introduction

**DVC (Data Version Control)** is an open-source tool that helps you:
- Version control your data files and models
- Reproduce machine learning experiments
- Manage machine learning pipelines
- Collaborate on data science projects
- Track changes across datasets

Unlike Git (which is optimized for code), DVC is designed to handle large files and machine learning workflows efficiently.

### Why Use DVC?

| Challenge | DVC Solution |
|-----------|--------------|
| Large files (>100MB) | Efficient storage & retrieval |
| Model versioning | Track model changes over time |
| Experiment reproducibility | Define and track pipelines |
| Team collaboration | Shared remote storage |
| Data pipeline management | Define stages and dependencies |

---

## Core Concepts

### 1. **DVC Repository Structure**

A DVC project contains:
- `.dvc/` - DVC configuration directory
- `.dvc/config` - DVC configuration file
- `.dvc/cache/` - Local cache of tracked files
- `.gitignore` - Git ignore rules (auto-generated by DVC)
- `*.dvc` - DVC metadata files
- `dvc.yaml` - Pipeline definition (optional)
- `dvc.lock` - Pipeline execution lock file (optional)

### 2. **DVC Files (.dvc)**

- **Purpose**: Track which files/directories are under DVC control
- **Format**: YAML format containing file metadata
- **Location**: Stored in Git, not in DVC storage
- **Example**:
```yaml
outs:
- md5: abc123def456
  size: 1048576
  hash: md5
  path: data
```

### 3. **Remote Storage**

- **Purpose**: Central storage location for tracked data
- **Types**: Local directory, S3, Azure Blob, Google Cloud Storage, etc.
- **Default Remote**: Usually marked as the default with `-d` flag
- **Multiple Remotes**: Can have multiple remotes with different names

### 4. **Cache**

- **Local Cache**: Stored in `.dvc/cache/` on your machine
- **Content-Addressable**: Files identified by MD5 hash
- **Space Efficient**: Hardlinks/symlinks to avoid duplication
- **Linked to Statistics**: Shows how much cache is being used

### 5. **Stages in Pipelines**

- **Definition**: A step in your data processing pipeline
- **Inputs**: Dependencies required by the stage
- **Outputs**: Results produced by the stage
- **Commands**: The actual command/script to run
- **Defined in**: `dvc.yaml` file

---

## Installation & Setup

### Prerequisites

- Python 3.7 or higher
- pip package manager
- Git installed and configured

### Installation Steps

#### 1. Install DVC

```bash
# Using pip (recommended)
pip install dvc

# Check installation
dvc version
```

#### 2. Install Storage Backend Support (Optional)

Depending on your remote storage type:

```bash
# For AWS S3
pip install dvc[s3]

# For Azure Blob Storage
pip install dvc[azure]

# For Google Cloud Storage
pip install dvc[gs]

# For HTTP/HTTPS
pip install dvc[http]

# All backends
pip install dvc[all]
```

#### 3. Verify Installation

```bash
# Check DVC version
dvc --version

# Check available commands
dvc --help
```

---

## Project Initialization

### Step 1: Initialize Git Repository

```bash
# Create new Git repository
git init

# Or clone existing repository
git clone <repo-url>
```

### Step 2: Initialize DVC

```bash
# Initialize DVC in the Git repository
dvc init

# This creates:
# - .dvc/ directory
# - .dvc/config file
# - .gitignore file
```

### Step 3: Configure DVC (Optional)

```bash
# Set user information
dvc config user.name "Your Name"
dvc config user.email "your.email@example.com"

# Set default remote
dvc config core.remote myremote

# Verify configuration
dvc config --list
```

### Step 4: Initial Commit

```bash
# Add DVC files to Git
git add .dvc .gitignore

# Commit
git commit -m "Initialize DVC"

# Push to remote
git push
```

---

## Remote Storage Configuration

### What is a Remote?

A **remote** is a centralized storage location where DVC pushes and pulls data files. It acts as a backup and enables collaboration.

### Types of Remotes

#### 1. **Local Storage** (Filesystem)
```bash
# Add local directory as remote
dvc remote add -d myremote /path/to/storage

# Or on Windows
dvc remote add -d myremote C:\path\to\storage
```

**Use case**: Testing, learning, shared network drives

#### 2. **AWS S3**
```bash
# Configure AWS credentials first
aws configure

# Add S3 bucket as remote
dvc remote add -d myremote s3://my-bucket/path

# With specific region
dvc remote add -d myremote s3://my-bucket/path -o region=us-west-2
```

#### 3. **Azure Blob Storage**
```bash
# Add Azure container as remote
dvc remote add -d myremote azure://container/path

# Set connection string or account name
dvc remote modify myremote connection_string "..."
```

#### 4. **Google Cloud Storage**
```bash
# Add GCS bucket as remote
dvc remote add -d myremote gs://my-bucket/path
```

#### 5. **HTTP/HTTPS**
```bash
# Add HTTP remote (read-only from DVC perspective)
dvc remote add myremote https://example.com/dvc-storage
```

### Managing Remotes

```bash
# List all remotes
dvc remote list

# Remove a remote
dvc remote remove myremote

# Rename a remote
dvc remote rename oldname newname

# Set as default
dvc remote default myremote

# Modify remote settings
dvc remote modify myremote option value

# View remote details
dvc remote list --show-origin
```

---

## Adding & Tracking Data

### Adding Files/Directories

```bash
# Add a directory
dvc add data/

# Add a specific file
dvc add data/sample.csv

# Add multiple items
dvc add file1.csv file2.csv directory/
```

### What Happens When You Add Files?

1. **Calculates MD5 hash** of the file content
2. **Creates `.dvc` file** with metadata
3. **Adds to `.gitignore`** to prevent Git tracking
4. **Adds to local cache** in `.dvc/cache/`
5. **Shows instructions** for next steps

### Updating Tracked Data

```bash
# Modify your data file

# Update DVC tracking
dvc commit data.dvc

# Or simply re-add
dvc add data/

# Push to remote
dvc push
```

### Removing Tracked Data

```bash
# Stop tracking with DVC (keeps files)
dvc remove data.dvc

# Also delete files
dvc remove data.dvc --outs

# Delete from remote storage
dvc remote remove myremote
```

---

## DVC Files & Metadata

### Understanding .dvc Files

A `.dvc` file is a YAML file that stores metadata about tracked files.

#### Example: data.dvc
```yaml
# Single directory
outs:
- hash: md5
  md5: a1b2c3d4e5f6g7h8i9j0k1l2m3n4o5
  size: 1048576
  path: data

# Multiple files
outs:
- hash: md5
  md5: abc123
  size: 512
  path: file1.csv
- hash: md5
  md5: def456
  size: 1024
  path: file2.csv
```

### File Structure Inside .dvc

```
.dvc/
‚îú‚îÄ‚îÄ cache/
‚îÇ   ‚îî‚îÄ‚îÄ files/
‚îÇ       ‚îî‚îÄ‚îÄ md5/
‚îÇ           ‚îú‚îÄ‚îÄ ab/
‚îÇ           ‚îÇ   ‚îú‚îÄ‚îÄ c123d456...
‚îÇ           ‚îÇ   ‚îî‚îÄ‚îÄ c789e012...
‚îÇ           ‚îî‚îÄ‚îÄ de/
‚îÇ               ‚îú‚îÄ‚îÄ f345g678...
‚îÇ               ‚îî‚îÄ‚îÄ h901i234...
‚îú‚îÄ‚îÄ config
‚îú‚îÄ‚îÄ .gitignore
‚îî‚îÄ‚îÄ tmp/
```

**Storage Format**:
- Files stored by their MD5 hash
- Two-character folder prefix from hash
- Space-efficient (deduplication)

### Inspecting DVC Files

```bash
# View .dvc file content
cat data.dvc

# Check file status
dvc status

# Show detailed information
dvc dag data.dvc

# List tracked files
dvc list -R data/
```

---

## Common Workflows

### Workflow 1: Simple Data Versioning

**Scenario**: You have a CSV file you want to version control

```bash
# 1. Add data to DVC
dvc add data/dataset.csv

# 2. Commit to Git
git add data.csv.dvc .gitignore
git commit -m "Add dataset v1"

# 3. Push to remote
dvc push

# 4. Push Git commits
git push

# --- Later, modify the data ---

# 5. Update the file (modify/replace data/dataset.csv)

# 6. Update DVC tracking
dvc add data/dataset.csv

# 7. Commit changes
git add data.csv.dvc
git commit -m "Update dataset v2"

# 8. Push updates
dvc push
git push
```

### Workflow 2: Data Pipeline

**Scenario**: You have a multi-stage pipeline (preprocess ‚Üí train ‚Üí evaluate)

```bash
# 1. Create pipeline stages in dvc.yaml
# (See Advanced Commands section)

# 2. Run pipeline
dvc repro

# 3. Commit pipeline definition
git add dvc.yaml dvc.lock
git commit -m "Add ML pipeline"

# 4. Push data
dvc push

# 5. Push Git changes
git push
```

### Workflow 3: Collaborative Workflow

**Scenario**: Team members working with shared data

```bash
# Team Member A:
# 1. Clone repository
git clone <repo-url>

# 2. Pull DVC data
dvc pull

# 3. Make changes to data
# ... modify files ...

# 4. Track changes
dvc add data/

# 5. Push data
dvc push

# 6. Commit metadata
git add data.dvc
git commit -m "Update data"
git push

# --- Team Member B ---
# 1. Pull latest changes
git pull

# 2. Fetch updated data
dvc pull
```

### Workflow 4: Experiment Tracking

**Scenario**: Running multiple ML experiments with different parameters

```bash
# 1. Set up pipeline with parameters

# 2. Run experiment
dvc exp run -n exp_v1 --set-param epochs=10

# 3. Run another experiment
dvc exp run -n exp_v2 --set-param epochs=20

# 4. Compare experiments
dvc exp show

# 5. Push experiments to remote
dvc exp push <remote>
```

---

## Advanced Commands

### 1. DVC Status & Information

```bash
# Check DVC status
dvc status

# Show changes compared to remote
dvc status --remote

# Detailed status
dvc status -v

# Check cache status
dvc cache dir
dvc cache status

# View DAG (Directed Acyclic Graph)
dvc dag
```

### 2. Data Synchronization

```bash
# Push data to remote
dvc push

# Push specific files
dvc push data.dvc

# Pull data from remote
dvc pull

# Pull specific files
dvc pull data.dvc

# Fetch without checking out
dvc fetch

# Forcefully push (overwrite remote)
dvc push --force

# Shallow push (latest versions only)
dvc push --shallow
```

### 3. Data Comparison & Diff

```bash
# Show differences in data
dvc diff

# Compare between versions
dvc diff --targets data/ <revision>

# Show metrics
dvc metrics show

# Plot comparisons
dvc plots show
```

### 4. Cache Management

```bash
# View cache directory
dvc cache dir

# Show cache size
dvc cache status

# Remove unused cache
dvc gc

# Remove all cache
dvc cache remove --all

# Configure cache settings
dvc config cache.type copy
```

### 5. Pipeline Commands (dvc.yaml)

```bash
# Run pipeline
dvc repro

# Run specific stage
dvc repro stage_name

# Show pipeline DAG
dvc dag

# List stages
dvc stage list

# Remove stage outputs
dvc gc --workspace
```

### 6. Remote Commands

```bash
# List files in remote
dvc remote list-hashes

# Cleanup remote
dvc gc --workspace --not-in-remote

# Configure remote settings
dvc remote modify myremote ssl_verify false
```

---

## Best Practices

### 1. **Version Control Strategy**

```bash
# ‚úÖ DO: Track data files with meaningful commits
git commit -m "Add training data v2.0 with 10K samples"

# ‚ùå DON'T: Vague commit messages
git commit -m "Update data"
```

### 2. **Remote Storage**

```bash
# ‚úÖ DO: Use reliable, backed-up storage
dvc remote add -d production s3://company-dvc-storage/project

# ‚ùå DON'T: Use personal computer as remote
dvc remote add -d backup /mnt/usb-drive/dvc-storage
```

### 3. **Large Files**

```bash
# ‚úÖ DO: Track large files with DVC
dvc add model.pkl

# ‚ùå DON'T: Track large files with Git
git add model.pkl
```

### 4. **Directory Structure**

```
project/
‚îú‚îÄ‚îÄ data/              # Raw and processed data (tracked by DVC)
‚îÇ   ‚îú‚îÄ‚îÄ raw/
‚îÇ   ‚îî‚îÄ‚îÄ processed/
‚îú‚îÄ‚îÄ models/            # Model files (tracked by DVC)
‚îú‚îÄ‚îÄ scripts/           # Python scripts (tracked by Git)
‚îú‚îÄ‚îÄ dvc.yaml          # Pipeline definition
‚îú‚îÄ‚îÄ dvc.lock          # Pipeline lock file
‚îú‚îÄ‚îÄ requirements.txt  # Python dependencies
‚îî‚îÄ‚îÄ README.md

# ‚úÖ DO: Organize files logically
# ‚ùå DON'T: Mix code and data without clear separation
```

### 5. **Commit Workflow**

```bash
# ‚úÖ DO: Commit DVC metadata to Git
git add data.dvc models/model.pkl.dvc
git commit -m "New model version"
dvc push

# ‚ùå DON'T: Forget to push DVC data
git commit -m "New model"
git push
# (missing: dvc push)
```

### 6. **Accessing Previous Versions**

```bash
# Tag versions in Git
git tag v1.0
git push origin v1.0

# Checkout previous version
git checkout v1.0
dvc checkout

# This gets old data versions
```

### 7. **Security**

```bash
# ‚úÖ DO: Use credentials for cloud storage
dvc remote modify myremote access_key_id <KEY>
dvc remote modify myremote secret_access_key <SECRET>

# ‚úÖ DO: Use .dvc/.config for sensitive data (local only)
# ‚ùå DON'T: Commit credentials to Git
git add .dvc/config  # Only local config
```

---

## Troubleshooting

### Issue 1: "File not found" when pulling

**Symptom**: `dvc pull` fails with "file not found"

**Solutions**:
```bash
# Check if remote is configured
dvc remote list

# Verify remote path exists
ls /path/to/remote/storage

# Re-authenticate (for cloud storage)
aws configure  # For S3
az login      # For Azure

# Reconfigure remote
dvc remote modify myremote option value
```

### Issue 2: Cache corruption

**Symptom**: "Corrupted cache" or hash mismatch errors

**Solutions**:
```bash
# Clear cache and re-pull
dvc cache remove --all
dvc pull

# Or just for specific file
rm .dvc/cache/ab/c123d456...
dvc pull data.dvc
```

### Issue 3: "Permission denied" errors

**Symptom**: Cannot push/pull from remote

**Solutions**:
```bash
# Check remote path permissions
chmod -R 755 /path/to/remote/storage

# For cloud storage, check credentials
dvc remote list --show-origin

# Re-authenticate
aws configure
```

### Issue 4: DVC and Git conflicts

**Symptom**: `.gitignore` or `.dvc` files have conflicts

**Solutions**:
```bash
# Never manually edit .gitignore
# Let DVC manage it

# Resolve conflicts
git checkout --theirs .gitignore
dvc add your_file

# Or use ours
git checkout --ours .gitignore
```

### Issue 5: Slow push/pull

**Symptom**: DVC operations are very slow

**Solutions**:
```bash
# Use parallel transfers
dvc push -j 4

# Check network connectivity
dvc remote list

# Use compression
dvc config cache.compression lz4

# Consider splitting large files
# Don't track single files > 1GB if possible
```

### Issue 6: Disk space issues

**Symptom**: "Not enough space" errors

**Solutions**:
```bash
# Check cache size
du -sh .dvc/cache

# Remove unused cache
dvc gc

# Remove old versions
dvc gc -w --not-in-remote

# Move cache to larger drive
dvc config cache.dir /mnt/large-drive/.dvc/cache
```

---

## Integration with Git

### .gitignore Management

DVC automatically adds entries to `.gitignore`:

```
# Automatically added by DVC
/data
/models

# Cache
.dvc/cache
.dvc/tmp
```

**Important**: Don't manually edit the DVC-generated parts of `.gitignore`

### Typical Git + DVC Workflow

```bash
# Step 1: Modify code
nano train.py

# Step 2: Commit code to Git
git add train.py
git commit -m "Improve model training"

# Step 3: Generate/modify data
python train.py

# Step 4: Track data with DVC
dvc add data/output.csv

# Step 5: Commit metadata to Git
git add data/output.csv.dvc
git commit -m "Generate output data"

# Step 6: Push both data and code
dvc push
git push
```

### Checking Out Previous Versions

```bash
# Checkout old Git commit
git checkout abc123def

# Get associated DVC data
dvc checkout

# Now you have both old code and old data
```

---

## Summary

| Task | Command |
|------|---------|
| Initialize DVC | `dvc init` |
| Add files | `dvc add <path>` |
| View status | `dvc status` |
| Push data | `dvc push` |
| Pull data | `dvc pull` |
| Configure remote | `dvc remote add -d myremote <path>` |
| Create pipeline | `dvc run/stage` |
| Run pipeline | `dvc repro` |
| Compare data | `dvc diff` |
| Clean cache | `dvc gc` |

---

## Resources

- **Official Documentation**: https://dvc.org/doc
- **Tutorial**: https://dvc.org/doc/start
- **GitHub Repository**: https://github.com/iterative/dvc
- **Community**: https://discord.gg/dvwXA2N
- **Blog**: https://dvc.org/blog

---

**Last Updated**: February 2026
**Version**: 1.0
